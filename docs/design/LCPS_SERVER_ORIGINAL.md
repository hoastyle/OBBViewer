LCPS è°ƒè¯•åŠŸèƒ½æ·±åº¦è¯„ä¼°ä¸ä¼˜åŒ–æ–¹æ¡ˆ                                                                                             
                                                                                                                            
ğŸ”§ ä½¿ç”¨çš„ MCP å·¥å…·                                                                                                          
                                                                                                                            
âœ… Sequential-thinking - 10æ­¥ç³»ç»ŸåŒ–å¤´è„‘é£æš´                                                                                 
  ç”¨é€”ï¼šæ·±åº¦è¯„ä¼°LCPSè°ƒè¯•åŠŸèƒ½å®Œå¤‡æ€§ï¼Œè®¾è®¡é»‘åŒ£å­å¼è‡ªåŠ¨å½•åˆ¶æœºåˆ¶                                                                
                                                                                                                            
---                                                                                                                         
ğŸ“Š å½“å‰è°ƒè¯•åŠŸèƒ½è¯„ä¼°                                                                                                         
                                                                                                                            
ç°æœ‰èƒ½åŠ›ç›˜ç‚¹                                                                                                                
                                                                                                                            
åŸºäºä»£ç åˆ†æï¼ŒLCPSå½“å‰å…·å¤‡ä»¥ä¸‹è°ƒè¯•åŠŸèƒ½ï¼š                                                                                    
                                                                                                                            
| åŠŸèƒ½        | å®ç°çŠ¶æ€  | è¦†ç›–èŒƒå›´    | è§¦å‘æ–¹å¼      | å®Œå¤‡æ€§è¯„åˆ†     |                                                  
|-------------|-----------|-------------|---------------|----------------|                                                  
| Contextå­˜å‚¨ | âœ… å·²å®ç° | 6ç§ç±»å‹     | æ‰‹åŠ¨/ç¢°æ’è§¦å‘ | â­â­â­ (60%)   |                                                  
| ç‚¹äº‘ä¿å­˜    | âœ… å·²å®ç° | å®Œæ•´ç‚¹äº‘    | ç¢°æ’æ—¶        | â­â­â­ (60%)   |                                                  
| OBBä¿å­˜     | âœ… å·²å®ç° | éšœç¢ç‰©+åŠå…· | ç¢°æ’æ—¶        | â­â­â­â­ (80%) |                                                  
| å›¾åƒä¿å­˜    | âœ… å·²å®ç° | é¢„ç¢°æ’å›¾åƒ  | ç‰¹å®šåœºæ™¯      | â­â­ (40%)     |                                                  
| æ—¥å¿—ç³»ç»Ÿ    | âœ… å·²å®ç° | æµç¨‹æ—¥å¿—    | å®æ—¶          | â­â­â­ (60%)   |                                                  
| æ€§èƒ½æ•°æ®    | âŒ æœªå®ç° | -           | -             | â­ (0%)        |                                                  
| å†³ç­–è·¯å¾„    | âŒ æœªå®ç° | -           | -             | â­ (0%)        |                                                  
| å¼‚å¸¸å‰æ•°æ®  | âŒ æœªå®ç° | -           | -             | â­ (0%)        |                                                  
                                                                                                                            
ç»¼åˆè¯„åˆ†: â­â­â­ (55/100)                                                                                                   
                                                                                                                            
å…³é”®ç¼ºé™·åˆ†æ                                                                                                                
                                                                                                                            
1. å¼‚å¸¸å‰æ•°æ®ç¼ºå¤± ğŸ”´ ä¸¥é‡                                                                                                   
                                                                                                                            
é—®é¢˜æè¿°:                                                                                                                   
// å½“å‰å®ç°ï¼šä»…åœ¨ç¢°æ’å‘ç”Ÿæ—¶ä¿å­˜æ•°æ®                                                                                         
if (SPR_CTRL_SAFE != curStatus) {                                                                                           
  saveContext(vObs, vObsOBB, ...);  // åªä¿å­˜å½“å‰å¸§                                                                         
}                                                                                                                           
                                                                                                                            
åæœ:                                                                                                                       
- âŒ æ— æ³•åˆ†æ"ä¸ºä»€ä¹ˆä¼šç¢°æ’"ï¼ˆç¼ºå°‘ç¢°æ’å‰30ç§’æ•°æ®ï¼‰                                                                           
- âŒ æ— æ³•é‡ç°å¼‚å¸¸åœºæ™¯ï¼ˆç¼ºå°‘å®Œæ•´ä¸Šä¸‹æ–‡ï¼‰                                                                                     
- âŒ éš¾ä»¥å®šä½æ ¹å› ï¼ˆç¼ºå°‘å†³ç­–è¿‡ç¨‹ï¼‰                                                                                           
                                                                                                                            
å®é™…æ¡ˆä¾‹:                                                                                                                   
ç¢°æ’å‘ç”Ÿåœ¨ T=100s                                                                                                           
ä¿å­˜æ•°æ®ï¼šT=100s çš„ OBBã€ç‚¹äº‘ã€çŠ¶æ€                                                                                         
ç¼ºå¤±æ•°æ®ï¼šT=70s-99s çš„æ¼”å˜è¿‡ç¨‹                                                                                              
ç»“æœï¼šåªçŸ¥é“ç¢°æ’æ—¶åˆ»çŠ¶æ€ï¼Œä¸çŸ¥é“å¦‚ä½•æ¼”å˜åˆ°ç¢°æ’                                                                              
                                                                                                                            
2. æ‰‹åŠ¨è§¦å‘ä½æ•ˆ ğŸŸ¡ ä¸­ç­‰                                                                                                     
                                                                                                                            
é—®é¢˜æè¿°:                                                                                                                   
# é…ç½®æ–‡ä»¶æ§åˆ¶                                                                                                              
record_context: true  # éœ€è¦æ‰‹åŠ¨å¼€å¯                                                                                        
debug_obstacle: [false, false]  # éœ€è¦æ‰‹åŠ¨é…ç½®                                                                              
                                                                                                                            
åæœ:                                                                                                                       
- âŒ ç”Ÿäº§ç¯å¢ƒé»˜è®¤å…³é—­ï¼ˆé¿å…å¼€é”€ï¼‰ï¼Œå¼‚å¸¸æ—¶æ— æ•°æ®                                                                             
- âŒ éœ€è¦"é¢„çŸ¥"å¼‚å¸¸æ‰èƒ½æå‰å¼€å¯å½•åˆ¶                                                                                         
- âŒ é—æ¼å¶å‘å¼‚å¸¸ï¼ˆå¦‚ï¼šæ¯å‘¨å‡ºç°1æ¬¡çš„ç½•è§bugï¼‰                                                                               
                                                                                                                            
3. æ–‡ä»¶ç¢ç‰‡åŒ– ğŸŸ¡ ä¸­ç­‰                                                                                                       
                                                                                                                            
é—®é¢˜æè¿°:                                                                                                                   
# å…¸å‹è°ƒè¯•ç›®å½•ç»“æ„                                                                                                          
mDebugDir/context/                                                                                                          
â”œâ”€â”€ config_context_1.bin                                                                                                    
â”œâ”€â”€ config_context_2.bin                                                                                                    
â”œâ”€â”€ ...                                                                                                                     
â”œâ”€â”€ config_context_1000.bin                                                                                                 
â”œâ”€â”€ pre_context_1.bin                                                                                                       
â”œâ”€â”€ pre_context_2.bin                                                                                                       
â”œâ”€â”€ ...                                                                                                                     
â””â”€â”€ result_context_1000.bin                                                                                                 
                                                                                                                            
# å•æ¬¡è°ƒè¯•ä¼šè¯å¯èƒ½äº§ç”Ÿ 6 Ã— 1000 = 6000 ä¸ªæ–‡ä»¶                                                                               
åæœ:                                                                                             
- âŒ æ–‡ä»¶ç³»ç»Ÿæ€§èƒ½ä¸‹é™ï¼ˆå¤§é‡å°æ–‡ä»¶ï¼‰                                                               
- âŒ æŸ¥è¯¢å›°éš¾ï¼ˆç¼ºå°‘ç´¢å¼•ï¼Œéœ€éå†æ–‡ä»¶åï¼‰                                                           
- âŒ å›æ”¾å¤æ‚ï¼ˆéœ€æ‰‹åŠ¨å…³è”ä¸åŒç±»å‹æ–‡ä»¶ï¼‰                                                           
                                                                                                  
4. ç¼ºå°‘æ€§èƒ½æ•°æ® ğŸ”´ ä¸¥é‡                                                                           
                                                                                                  
é—®é¢˜æè¿°:                                                                                         
- æ— CPU/å†…å­˜ä½¿ç”¨ç‡è®°å½•                                                                            
- æ— å¸§ç‡/å»¶è¿Ÿç»Ÿè®¡                                                                                 
- æ— æ¨¡å—è€—æ—¶åˆ†è§£                                                                                  
                                                                                                  
åæœ:                                                                                             
- âŒ æ€§èƒ½é—®é¢˜éš¾ä»¥å®šä½ï¼ˆå¦‚ï¼šå¸§ç‡ä¸‹é™åˆ°10Hzï¼‰                                                       
- âŒ æ— æ³•è¯†åˆ«æ€§èƒ½ç“¶é¢ˆï¼ˆç‚¹äº‘å¤„ç†ï¼ŸOBBè®¡ç®—ï¼Ÿï¼‰                                                      
- âŒ ä¼˜åŒ–ç¼ºä¹æ•°æ®æ”¯æ’‘                                                                             
                                                                                                  
5. å†³ç­–è¿‡ç¨‹ä¸é€æ˜ ğŸ”´ ä¸¥é‡                                                                         
                                                                                                  
é—®é¢˜æè¿°:                                                                                         
// ä»…ä¿å­˜æœ€ç»ˆå†³ç­–ç»“æœ                                                                             
if (mbRecordContext) {                                                                            
  mProcessResult[TYPE_PROCESS] = ret;  // RET_NORMAL / RET_ERROR / RET_SKIP                       
}                                                                                                 
                                                                                                  
åæœ:                                                                                             
- âŒ ä¸çŸ¥é“ä¸ºä»€ä¹ˆåšå‡ºæŸä¸ªå†³ç­–                                                                     
- âŒ æ— æ³•éªŒè¯å†³ç­–é€»è¾‘æ­£ç¡®æ€§                                                                       
- âŒ è¯¯æŠ¥/æ¼æŠ¥éš¾ä»¥åˆ†æ                                                                            
                                                                                                  
å®é™…éœ€æ±‚:                                                                                         
éœ€è¦çŸ¥é“ï¼š                                                                                        
1. æ£€æµ‹åˆ°éšœç¢ç‰©Aï¼Œè·ç¦»3.5m                                                                        
2. è®¡ç®—åŠå…·é€Ÿåº¦ 0.5m/s                                                                            
3. é¢„æµ‹ç¢°æ’æ—¶é—´ 7s                                                                                
4. åº”ç”¨å®‰å…¨ä½™é‡ 2x                                                                                
5. å†³ç­–ï¼šSLOW (å‡é€Ÿ)                                                                              
6. ä¸ºä»€ä¹ˆä¸æ˜¯STOPï¼Ÿå› ä¸ºè·ç¦»>3.0må®‰å…¨é˜ˆå€¼                                                          
                                                                                                  
---                                                                                               
ğŸ¯ ä¼˜åŒ–æ–¹æ¡ˆï¼šé»‘åŒ£å­å¼è°ƒè¯•ç³»ç»Ÿ                                                                     
                                                                                                  
æ ¸å¿ƒè®¾è®¡ç†å¿µ                                                                                      
                                                                                                  
ç±»æ¯”: èˆªç©ºé»‘åŒ£å­ï¼ˆFlight Data Recorderï¼‰ + æ±½è½¦EDRï¼ˆEvent Data Recorderï¼‰                         
                                                                                                  
å…³é”®ç‰¹æ€§:                                                                                         
1. âœ… æŒç»­å½•åˆ¶ - ç¯å½¢ç¼“å†²ï¼Œä¿ç•™æœ€è¿‘Nç§’æ•°æ®                                                        
2. âœ… å¼‚å¸¸è§¦å‘ - æ£€æµ‹åˆ°å¼‚å¸¸è‡ªåŠ¨ä¿å­˜                                                               
3. âœ… å®Œæ•´ä¸Šä¸‹æ–‡ - å¼‚å¸¸å‰åå®Œæ•´æ•°æ®                                                               
4. âœ… éä¾µå…¥æ€§ - ä¸å½±å“LCPSä¸»åŠŸèƒ½                                                                 
5. âœ… è‡ªåŠ¨åŒ– - é›¶é…ç½®ï¼Œå¼€ç®±å³ç”¨                                                                   
                                                                                                  
æ¶æ„è®¾è®¡                                                                                          
                                                                                                  
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                    
â”‚                    LCPS ä¸»é€»è¾‘çº¿ç¨‹                         â”‚                                    
â”‚  (processFrame, collisionCheck, safetyDecision)           â”‚                                     
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                    
             â”‚ æ•°æ®æµ                                                                             
             â†“                                                                                    
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                    
â”‚              é»‘åŒ£å­å½•åˆ¶ç³»ç»Ÿï¼ˆç‹¬ç«‹çº¿ç¨‹ï¼‰                     â”‚                                   
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚                                     
â”‚  â”‚  Layer 1: ç¯å½¢ç¼“å†²åŒºç®¡ç†                         â”‚     â”‚                                     
â”‚  â”‚  - CircularBuffer<Frame> (30ç§’æ•°æ®)             â”‚     â”‚                                      
â”‚  â”‚  - æŒç»­å†™å…¥æœ€æ–°æ•°æ®                               â”‚     â”‚                                    
â”‚  â”‚  - è¦†ç›–æœ€æ—§æ•°æ®                                   â”‚     â”‚                                    
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚                                     
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚                                     
â”‚  â”‚  Layer 2: å¼‚å¸¸æ£€æµ‹å¼•æ“                           â”‚     â”‚                                     
â”‚  â”‚  - ç¡¬å¼‚å¸¸ï¼šç¢°æ’ã€ç´§æ€¥åœè½¦ã€ä¼ æ„Ÿå™¨æ•…éšœ            â”‚     â”‚                                     
â”‚  â”‚  - è½¯å¼‚å¸¸ï¼šæ€§èƒ½ä¸‹é™ã€å†³ç­–æŠ–åŠ¨ã€å»¶è¿Ÿå¢åŠ           â”‚     â”‚                                     
â”‚  â”‚  - é¢„æµ‹å¼‚å¸¸ï¼šæ¥è¿‘ç¢°æ’ã€é¢‘ç¹å‡é€Ÿ                  â”‚     â”‚                                     
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚                                     
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚                                     
â”‚  â”‚  Layer 3: å¼‚æ­¥æ•°æ®æŒä¹…åŒ–                         â”‚     â”‚                                     
â”‚  â”‚  - å¼‚å¸¸è§¦å‘ï¼šä¿å­˜ç¼“å†²åŒº + åç»­10ç§’æ•°æ®           â”‚     â”‚                                     
â”‚  â”‚  - HDF5æ ¼å¼ï¼šç»Ÿä¸€å­˜å‚¨ï¼Œæ—¶é—´æˆ³ç´¢å¼•                â”‚     â”‚                                     
â”‚  â”‚  - å‹ç¼©ç­–ç•¥ï¼šzstd level 6 (~74%å‹ç¼©ç‡)          â”‚     â”‚                                      
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚                                     
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚                                     
â”‚  â”‚  Layer 4: è‡ªåŠ¨åŒ–æŠ¥å‘Šç”Ÿæˆ                         â”‚     â”‚                                     
â”‚  â”‚  - å¼‚å¸¸æ¦‚è¦ï¼ˆæ—¶é—´ã€ç±»å‹ã€ä¸¥é‡æ€§ï¼‰                â”‚     â”‚                                     
â”‚  â”‚  - æ—¶é—´çº¿åˆ†æï¼ˆå¼‚å¸¸å‰åäº‹ä»¶åºåˆ—ï¼‰                â”‚     â”‚                                     
â”‚  â”‚  - æ€§èƒ½åˆ†æï¼ˆCPU/å†…å­˜/å¸§ç‡æ›²çº¿ï¼‰                 â”‚     â”‚                                     
â”‚  â”‚  - MarkdownæŠ¥å‘Š + å›¾è¡¨                          â”‚     â”‚                                      
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚                                     
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                    
                                                                                                      
---                                                                                                   
ğŸ’¡ åˆ›æ–°åŠŸèƒ½è®¾è®¡                                                                                       
                                                                                                      
åŠŸèƒ½1: ç¯å½¢ç¼“å†² + å¼‚å¸¸å‰åå½•åˆ¶                                                                        
                                                                                                      
è®¾è®¡ç›®æ ‡: è‡ªåŠ¨ä¿å­˜å¼‚å¸¸å‰30ç§’ + å¼‚å¸¸å10ç§’æ•°æ®                                                         
                                                                                                      
å®ç°æ–¹æ¡ˆ:                                                                                             
                                                                                                      
// æ–°å¢ç±»ï¼šBlackBoxRecorder                                                                           
class BlackBoxRecorder {                                                                              
 public:                                                                                              
  struct Frame {                                                                                      
    double timestamp;                                                                                 
    std::vector<std::shared_ptr<OBBox>> obb_data;                                                     
    PCLPointCloudPtr pointcloud;                                                                      
    LCPS_SRV_STATE srv_state;                                                                         
    LCPS_CRANE_STATE crane_state;                                                                     
    DecisionTrace decision_trace;  // æ–°å¢ï¼šå†³ç­–è·¯å¾„                                                  
    PerformanceMetrics perf_metrics;  // æ–°å¢ï¼šæ€§èƒ½æ•°æ®                                               
  };                                                                                                  
                                                                                                      
  // ç¯å½¢ç¼“å†²åŒºï¼ˆä¿ç•™30ç§’æ•°æ®ï¼Œå‡è®¾30Hz = 900å¸§ï¼‰                                                     
  boost::circular_buffer<Frame> ring_buffer_{900};                                                    
                                                                                                      
  // æŒç»­å†™å…¥æ•°æ®                                                                                     
  void PushFrame(const Frame& frame) {                                                                
    std::lock_guard<std::mutex> lock(mutex_);                                                         
    ring_buffer_.push_back(frame);                                                                    
  }                                                                                                   
                                                                                                      
  // å¼‚å¸¸è§¦å‘ï¼šä¿å­˜ç¼“å†²åŒº + åç»­æ•°æ®                                                                  
  void TriggerAnomalyRecording(                                                                       
      AnomalyType type,                                                                               
      const std::string& reason) {                                                                    
                                                                                                      
    is_recording_anomaly_ = true;                                                                     
    anomaly_start_time_ = GetCurrentTime();                                                           
                                                                                                      
    // Step 1: å¤åˆ¶ç¯å½¢ç¼“å†²åŒºæ•°æ®ï¼ˆå¼‚å¸¸å‰30ç§’ï¼‰                                                       
    std::vector<Frame> pre_anomaly_data;                                                              
    {                                                                                                 
      std::lock_guard<std::mutex> lock(mutex_);                                                       
      pre_anomaly_data.assign(                                                                        
        ring_buffer_.begin(),                                                                         
        ring_buffer_.end()                                                                            
      );                                                                                              
    }                                                                                                 
                                                                                                      
    // Step 2: ç»§ç»­å½•åˆ¶åç»­10ç§’æ•°æ®                                                                   
    // (åœ¨åå°çº¿ç¨‹ä¸­å¼‚æ­¥å®Œæˆ)                                                                         
                                                                                                      
    // Step 3: ä¿å­˜åˆ°HDF5                                                                             
    std::string filename = GenerateAnomalyFilename(type);                                             
    SaveToHDF5(filename, pre_anomaly_data);                                                           
                                                                                                      
    // Step 4: ç”Ÿæˆè‡ªåŠ¨åŒ–æŠ¥å‘Š                                                                         
    GenerateAnomalyReport(filename, type, reason);                                                    
  }                                                                                                   
                                                                                                      
 private:                                                                                             
  bool is_recording_anomaly_ = false;                                                                 
  double anomaly_start_time_ = 0;                                                                     
  std::mutex mutex_;                                                                                  
};                                                                                                    
                                                                                                      
æ•°æ®æµç¤ºä¾‹:                                                                                           
                                                                                                      
æ—¶é—´çº¿ï¼š                                                                                              
T=0s    T=70s   T=100s(å¼‚å¸¸)  T=110s   T=120s                                                         
|-------|-------|-------------|--------|--------|                                                     
        |<- ç¯å½¢ç¼“å†²(30s) ->|                                                                         
                |<-  ä¿å­˜èŒƒå›´  ->|                                                                    
                                                                                                      
ä¿å­˜æ•°æ®ï¼š                                                                                            
- T=70s-100s: ç¯å½¢ç¼“å†²åŒºæ•°æ®ï¼ˆå¼‚å¸¸å‰ï¼‰                                                                
- T=100s-110s: å®æ—¶å½•åˆ¶æ•°æ®ï¼ˆå¼‚å¸¸åï¼‰                                                                 
- æ€»è®¡ï¼š40ç§’å®Œæ•´æ•°æ®                                                                                  
                                                                                                      
æ€§èƒ½å¼€é”€:                                                                                             
- ç¯å½¢ç¼“å†²å†™å…¥ï¼šO(1)ï¼Œæ— é¢å¤–å¼€é”€                                                                      
- å†…å­˜å ç”¨ï¼š900å¸§ Ã— ~500KB/å¸§ = ~450MB                                                                
- å¼‚å¸¸è§¦å‘ä¿å­˜ï¼šå¼‚æ­¥çº¿ç¨‹ï¼Œä¸é˜»å¡ä¸»é€»è¾‘                                                                
                                                                                                      
---                                                                                                   
åŠŸèƒ½2: æ™ºèƒ½å¼‚å¸¸æ£€æµ‹å¼•æ“                                                                    
                                                                                           
è®¾è®¡ç›®æ ‡: è‡ªåŠ¨æ£€æµ‹8ç±»å¼‚å¸¸ï¼Œè§¦å‘å½•åˆ¶                                                        
                                                                                           
å¼‚å¸¸åˆ†ç±»å’Œæ£€æµ‹é€»è¾‘:                                                                        
                                                                                           
| å¼‚å¸¸ç±»å‹             | æ£€æµ‹æ–¹å¼   | è§¦å‘æ¡ä»¶                  | ä¸¥é‡æ€§      |            
|----------------------|------------|---------------------------|-------------|            
| ç¡¬å¼‚å¸¸-1: ç¢°æ’å‘ç”Ÿ   | å®‰å…¨å†³ç­–   | curStatus == STOP         | ğŸ”´ Critical |            
| ç¡¬å¼‚å¸¸-2: ä¼ æ„Ÿå™¨æ•…éšœ | æ•°æ®æœ‰æ•ˆæ€§ | pointcloud.empty() > 3å¸§  | ğŸ”´ Critical |            
| ç¡¬å¼‚å¸¸-3: ç´§æ€¥åœè½¦   | çŠ¶æ€è½¬æ¢   | SAFE â†’ STOP (è·³è¿‡SLOW)    | ğŸ”´ Critical |            
| è½¯å¼‚å¸¸-4: æ€§èƒ½ä¸‹é™   | å¸§ç‡ç»Ÿè®¡   | fps < 20Hz (è¿ç»­5ç§’)      | ğŸŸ¡ Warning  |            
| è½¯å¼‚å¸¸-5: å†³ç­–æŠ–åŠ¨   | å†³ç­–å˜åŒ–   | SAFE â†” SLOW (é¢‘ç‡>5æ¬¡/ç§’) | ğŸŸ¡ Warning  |            
| è½¯å¼‚å¸¸-6: å»¶è¿Ÿå¢åŠ    | å¤„ç†æ—¶é—´   | frame_time > 100ms        | ğŸŸ¡ Warning  |            
| é¢„æµ‹å¼‚å¸¸-7: æ¥è¿‘ç¢°æ’ | è·ç¦»é˜ˆå€¼   | min_distance < 3.0m       | ğŸŸ¢ Info     |            
| é¢„æµ‹å¼‚å¸¸-8: é¢‘ç¹å‡é€Ÿ | å‡é€Ÿæ¬¡æ•°   | SLOWæ¬¡æ•° > 10æ¬¡/åˆ†é’Ÿ      | ğŸŸ¢ Info     |            
                                                                                           
å®ç°ä»£ç :                                                                                  
                                                                                           
class AnomalyDetector {                                                                    
 public:                                                                                   
  enum AnomalyType {                                                                       
    COLLISION,                                                                             
    SENSOR_FAILURE,                                                                        
    EMERGENCY_STOP,                                                                        
    PERFORMANCE_DROP,                                                                      
    DECISION_OSCILLATION,                                                                  
    HIGH_LATENCY,                                                                          
    NEAR_COLLISION,                                                                        
    FREQUENT_SLOWDOWN                                                                      
  };                                                                                       
                                                                                           
  // æ£€æµ‹å¼‚å¸¸ï¼ˆæ¯å¸§è°ƒç”¨ï¼‰                                                                  
  std::optional<AnomalyType> DetectAnomaly(                                                
      const BlackBoxRecorder::Frame& frame) {                                              
                                                                                           
    // 1. ç¡¬å¼‚å¸¸æ£€æµ‹                                                                       
    if (frame.srv_state.curStatus == SPR_CTRL_STOP) {                                      
      return COLLISION;                                                                    
    }                                                                                      
                                                                                           
    if (IsEmptyPointCloud(frame.pointcloud, 3)) {                                          
      return SENSOR_FAILURE;                                                               
    }                                                                                      
                                                                                           
    if (IsEmergencyStop(frame.srv_state)) {                                                
      return EMERGENCY_STOP;                                                               
    }                                                                                      
                                                                                           
    // 2. è½¯å¼‚å¸¸æ£€æµ‹                                                                       
    if (frame.perf_metrics.fps < 20.0 &&                                                   
        low_fps_duration_ > 5.0) {                                                         
      return PERFORMANCE_DROP;                                                             
    }                                                                                      
                                                                                           
    if (IsDecisionOscillation(frame.srv_state, 5.0)) {                                     
      return DECISION_OSCILLATION;                                                         
    }                                                                                      
                                                                                           
    if (frame.perf_metrics.frame_time_ms > 100.0) {                                        
      return HIGH_LATENCY;                                                                 
    }                                                                                      
                                                                                           
    // 3. é¢„æµ‹å¼‚å¸¸æ£€æµ‹                                                                     
    if (frame.decision_trace.min_obstacle_distance < 3.0) {                                
      return NEAR_COLLISION;                                                               
    }                                                                                      
                                                                                           
    if (slowdown_count_ > 10) {  // æœ€è¿‘1åˆ†é’Ÿ                                              
      return FREQUENT_SLOWDOWN;                                                            
    }                                                                                      
                                                                                           
    return std::nullopt;  // æ— å¼‚å¸¸                                                        
  }                                                                                        
 private:                                                                        
  double low_fps_duration_ = 0;                                                  
  int slowdown_count_ = 0;                                                       
                                                                                 
  bool IsDecisionOscillation(                                                    
      const LCPS_SRV_STATE& state,                                               
      double threshold_hz) {                                                     
    // æ£€æµ‹ SAFE â†” SLOW é¢‘ç¹åˆ‡æ¢                                                 
    decision_history_.push_back(state.curStatus);                                
    if (decision_history_.size() < 10) return false;                             
                                                                                 
    int transitions = 0;                                                         
    for (size_t i = 1; i < decision_history_.size(); ++i) {                      
      if (decision_history_[i] != decision_history_[i-1]) {                      
        transitions++;                                                           
      }                                                                          
    }                                                                            
                                                                                 
    double frequency = transitions /                                             
      (decision_history_.size() / 30.0);  // Hz                                  
    return frequency > threshold_hz;                                             
  }                                                                              
};                                                                               
                                                                                 
è§¦å‘ç­–ç•¥:                                                                        
                                                                                 
// é›†æˆåˆ°LCPSä¸»å¾ªç¯                                                              
void LCPS::processFrame(...) {                                                   
  // ... ç°æœ‰é€»è¾‘ ...                                                            
                                                                                 
  // æ–°å¢ï¼šé»‘åŒ£å­å½•åˆ¶                                                            
  BlackBoxRecorder::Frame frame = {                                              
    .timestamp = GetCurrentTime(),                                               
    .obb_data = vObsOBB,                                                         
    .pointcloud = mpFullCloud,                                                   
    .srv_state = mSrvState,                                                      
    .crane_state = craneState,                                                   
    .decision_trace = mDecisionTrace,                                            
    .perf_metrics = CollectPerfMetrics()                                         
  };                                                                             
                                                                                 
  black_box_recorder_->PushFrame(frame);                                         
                                                                                 
  // å¼‚å¸¸æ£€æµ‹                                                                    
  auto anomaly = anomaly_detector_->DetectAnomaly(frame);                        
  if (anomaly.has_value()) {                                                     
    std::string reason = GetAnomalyReason(*anomaly);                             
    black_box_recorder_->TriggerAnomalyRecording(                                
      *anomaly, reason                                                           
    );                                                                           
    MM_WARN("[BlackBox] Anomaly detected: %s", reason.c_str());                  
  }                                                                              
}                                                                                
                                                                                 
---                                                                              
åŠŸèƒ½3: åˆ†å±‚æ•°æ®å½•åˆ¶ç­–ç•¥                                                          
                                                                                 
è®¾è®¡ç›®æ ‡: å¹³è¡¡å­˜å‚¨å¼€é”€å’Œè°ƒè¯•å®Œæ•´æ€§                                               
                                                                                 
æ•°æ®åˆ†å±‚:                                                                        
                                                                                 
Layer 1 (å…³é”®æ•°æ®ï¼Œå§‹ç»ˆå½•åˆ¶):                                                    
  - OBBæ•°æ® (éšœç¢ç‰© + åŠå…·)                                                      
  - å®‰å…¨å†³ç­–ç»“æœ (SAFE/SLOW/STOP)                                                
  - åŠå…·ä½ç½®å’Œé€Ÿåº¦                                                               
  - ç³»ç»ŸçŠ¶æ€ (srv_state)                                                         
  - æ—¶é—´æˆ³                                                                       
  å­˜å‚¨å¼€é”€: ~5KB/å¸§ Ã— 30Hz = ~150KB/s                                            
                                                                                 
Layer 2 (é‡è¦æ•°æ®ï¼Œå¼‚å¸¸æ—¶å½•åˆ¶):                                                  
  - å®Œæ•´ç‚¹äº‘ (100kç‚¹)                                                            
  - ä¼ æ„Ÿå™¨åŸå§‹æ•°æ®                                                               
  - ä¸­é—´è®¡ç®—ç»“æœ (è·ç¦»ã€é€Ÿåº¦ã€é¢„æµ‹)                                              
  - å†³ç­–æ ‘è·¯å¾„                                                                   
  å­˜å‚¨å¼€é”€: ~500KB/å¸§ Ã— 30Hz = ~15MB/s                                           
                                                                                 
Layer 3 (è¾…åŠ©æ•°æ®ï¼Œå¯é€‰å½•åˆ¶):                                                    
  - æ€§èƒ½æŒ‡æ ‡ (CPUã€å†…å­˜ã€å¸§ç‡)                                                   
  - å†…å­˜å¿«ç…§                                                                     
  - è¯¦ç»†æ—¥å¿—                                                                     
  - å¯è§†åŒ–å›¾åƒ                                                                   
  å­˜å‚¨å¼€é”€: ~100KB/å¸§ Ã— 30Hz = ~3MB/s                                            
                                                                                 
å­˜å‚¨ç­–ç•¥:                                                                   
                                                                            
| è¿è¡Œæ¨¡å¼ | å½•åˆ¶å±‚çº§    | å­˜å‚¨é€Ÿç‡ | ç£ç›˜å ç”¨ï¼ˆ1å°æ—¶ï¼‰ |                   
|----------|-------------|----------|-------------------|                   
| å¸¸æ€è¿è¡Œ | Layer 1     | ~150KB/s | ~540MB/å°æ—¶       |                   
| å¼‚å¸¸å½•åˆ¶ | Layer 1+2+3 | ~18MB/s  | ~65GB/å°æ—¶        |                   
| è°ƒè¯•æ¨¡å¼ | Layer 1+2+3 | ~18MB/s  | ~65GB/å°æ—¶        |                   
                                                                            
å®ç°:                                                                       
                                                                            
struct RecordingConfig {                                                    
  bool enable_layer1 = true;   // å§‹ç»ˆå¼€å¯                                  
  bool enable_layer2 = false;  // å¼‚å¸¸æ—¶å¼€å¯                                
  bool enable_layer3 = false;  // æ‰‹åŠ¨å¼€å¯                                  
};                                                                          
                                                                            
void BlackBoxRecorder::PushFrame(const Frame& frame) {                      
  // Layer 1: å§‹ç»ˆå½•åˆ¶                                                      
  if (config_.enable_layer1) {                                              
    FrameLayer1 layer1 = {                                                  
      .timestamp = frame.timestamp,                                         
      .obb_data = frame.obb_data,                                           
      .safety_decision = frame.srv_state.curStatus,                         
      .spreader_pos = frame.crane_state.hardState.pos,                      
      // ...                                                                
    };                                                                      
    ring_buffer_layer1_.push_back(layer1);                                  
  }                                                                         
                                                                            
  // Layer 2: å¼‚å¸¸æ—¶å½•åˆ¶                                                    
  if (config_.enable_layer2 || is_recording_anomaly_) {                     
    FrameLayer2 layer2 = {                                                  
      .pointcloud = frame.pointcloud,                                       
      .decision_trace = frame.decision_trace,                               
      // ...                                                                
    };                                                                      
    ring_buffer_layer2_.push_back(layer2);                                  
  }                                                                         
                                                                            
  // Layer 3: è°ƒè¯•æ¨¡å¼å½•åˆ¶                                                  
  if (config_.enable_layer3) {                                              
    FrameLayer3 layer3 = {                                                  
      .perf_metrics = frame.perf_metrics,                                   
      .memory_snapshot = CaptureMemorySnapshot(),                           
      // ...                                                                
    };                                                                      
    ring_buffer_layer3_.push_back(layer3);                                  
  }                                                                         
}                                                                           
                                                                            
---                                                                         
åŠŸèƒ½4: å†³ç­–è¿‡ç¨‹å›æº¯ï¼ˆDecision Traceï¼‰                                       
                                                                            
è®¾è®¡ç›®æ ‡: è®°å½•å®Œæ•´å†³ç­–é€»è¾‘ï¼Œæ”¯æŒäº‹ååˆ†æ                                    
                                                                            
æ•°æ®ç»“æ„:                                                                   
                                                                            
struct DecisionNode {                                                       
  std::string node_name;        // å†³ç­–èŠ‚ç‚¹åç§°                             
  double timestamp;             // æ—¶é—´æˆ³                                   
  json input_params;            // è¾“å…¥å‚æ•°ï¼ˆJSONæ ¼å¼ï¼‰                     
  json output_result;           // è¾“å‡ºç»“æœ                                 
  std::string branch_reason;    // é€‰æ‹©åˆ†æ”¯åŸå›                              
  double confidence;            // ç½®ä¿¡åº¦ [0-1]                             
};                                                                          
                                                                            
struct DecisionTrace {                                                      
  std::vector<DecisionNode> nodes;  // å†³ç­–è·¯å¾„                             
  std::string final_decision;       // æœ€ç»ˆå†³ç­–                             
  double min_obstacle_distance;     // æœ€å°éšœç¢ç‰©è·ç¦»                       
  double predicted_collision_time;  // é¢„æµ‹ç¢°æ’æ—¶é—´                         
};                                                                          
                                                                            
ä½¿ç”¨ç¤ºä¾‹:                                                                            
                                                                                     
DecisionTrace LCPS::collisionCheck(...) {                                            
  DecisionTrace trace;                                                               
                                                                                     
  // èŠ‚ç‚¹1: éšœç¢ç‰©æ£€æµ‹                                                               
  DecisionNode node1 = {                                                             
    .node_name = "ObstacleDetection",                                                
    .timestamp = GetCurrentTime(),                                                   
    .input_params = {                                                                
      {"pointcloud_size", mpFullCloud->size()},                                      
      {"obb_count", vObsOBB.size()}                                                  
    },                                                                               
    .output_result = {                                                               
      {"obstacles_detected", vObsOBB.size()},                                        
      {"min_distance", min_distance}                                                 
    },                                                                               
    .branch_reason = "Detected 3 obstacles within range",                            
    .confidence = 0.95                                                               
  };                                                                                 
  trace.nodes.push_back(node1);                                                      
                                                                                     
  // èŠ‚ç‚¹2: ç¢°æ’é¢„æµ‹                                                                 
  DecisionNode node2 = {                                                             
    .node_name = "CollisionPrediction",                                              
    .timestamp = GetCurrentTime(),                                                   
    .input_params = {                                                                
      {"spreader_speed", sprSpeed},                                                  
      {"min_distance", min_distance}                                                 
    },                                                                               
    .output_result = {                                                               
      {"predicted_time", predicted_time},                                            
      {"collision_risk", "medium"}                                                   
    },                                                                               
    .branch_reason =                                                                 
      fmt::format("Time to collision: {:.1f}s", predicted_time),                     
    .confidence = 0.88                                                               
  };                                                                                 
  trace.nodes.push_back(node2);                                                      
                                                                                     
  // èŠ‚ç‚¹3: å®‰å…¨å†³ç­–                                                                 
  SPR_CTRL_STATUS decision;                                                          
  std::string reason;                                                                
  if (min_distance < 2.0) {                                                          
    decision = SPR_CTRL_STOP;                                                        
    reason = "Distance < 2.0m (STOP threshold)";                                     
  } else if (min_distance < 3.5) {                                                   
    decision = SPR_CTRL_SLOW;                                                        
    reason = "Distance < 3.5m (SLOW threshold)";                                     
  } else {                                                                           
    decision = SPR_CTRL_SAFE;                                                        
    reason = "Distance >= 3.5m (safe zone)";                                         
  }                                                                                  
                                                                                     
  DecisionNode node3 = {                                                             
    .node_name = "SafetyDecision",                                                   
    .timestamp = GetCurrentTime(),                                                   
    .input_params = {                                                                
      {"min_distance", min_distance},                                                
      {"stop_threshold", 2.0},                                                       
      {"slow_threshold", 3.5}                                                        
    },                                                                               
    .output_result = {                                                               
      {"decision", DecisionToString(decision)}                                       
    },                                                                               
    .branch_reason = reason,                                                         
    .confidence = 1.0                                                                
  };                                                                                 
  trace.nodes.push_back(node3);                                                      
                                                                                     
  trace.final_decision = DecisionToString(decision);                                 
  trace.min_obstacle_distance = min_distance;                                        
  trace.predicted_collision_time = predicted_time;                                   
                                                                                     
  return trace;                                                                      
}                                                                                    
                                                                                     
å¯è§†åŒ–ç¤ºä¾‹:                                                                            
                                                                                       
å†³ç­–è·¯å¾„å¯è§†åŒ–ï¼ˆå¼‚å¸¸æŠ¥å‘Šä¸­è‡ªåŠ¨ç”Ÿæˆï¼‰:                                                  
                                                                                       
ObstacleDetection (95% confidence)                                                     
  Input: pointcloud_size=98532, obb_count=3                                            
  Output: obstacles_detected=3, min_distance=2.8m                                      
  Reason: "Detected 3 obstacles within range"                                          
  â†“                                                                                    
CollisionPrediction (88% confidence)                                                   
  Input: spreader_speed=0.5m/s, min_distance=2.8m                                      
  Output: predicted_time=5.6s, collision_risk=medium                                   
  Reason: "Time to collision: 5.6s"                                                    
  â†“                                                                                    
SafetyDecision (100% confidence)                                                       
  Input: min_distance=2.8m, stop_threshold=2.0m, slow_threshold=3.5m                   
  Output: decision=SLOW                                                                
  Reason: "Distance < 3.5m (SLOW threshold)"                                           
  â†“                                                                                    
Final Decision: SLOW                                                                   
                                                                                       
---                                                                                    
åŠŸèƒ½5: åµŒå…¥å¼æ€§èƒ½ç›‘æ§                                                                  
                                                                                       
è®¾è®¡ç›®æ ‡: å®æ—¶ç›‘æ§ç³»ç»Ÿæ€§èƒ½ï¼Œæ£€æµ‹ç“¶é¢ˆ                                                   
                                                                                       
ç›‘æ§æŒ‡æ ‡:                                                                              
                                                                                       
struct PerformanceMetrics {                                                            
  // æ—¶é—´æŒ‡æ ‡                                                                          
  double frame_time_ms;         // æ€»å¸§å¤„ç†æ—¶é—´                                        
  double obb_detection_ms;      // OBBæ£€æµ‹è€—æ—¶                                         
  double collision_check_ms;    // ç¢°æ’æ£€æŸ¥è€—æ—¶                                        
  double pointcloud_process_ms; // ç‚¹äº‘å¤„ç†è€—æ—¶                                        
  double decision_time_ms;      // å†³ç­–è€—æ—¶                                            
                                                                                       
  // é¢‘ç‡æŒ‡æ ‡                                                                          
  double fps;                   // å®æ—¶å¸§ç‡                                            
  int dropped_frames;           // ä¸¢å¸§æ¬¡æ•°                                            
                                                                                       
  // èµ„æºæŒ‡æ ‡                                                                          
  size_t memory_usage_mb;       // å†…å­˜ä½¿ç”¨é‡                                          
  double cpu_usage_percent;     // CPUä½¿ç”¨ç‡                                           
  size_t pointcloud_size;       // ç‚¹äº‘å¤§å°                                            
  size_t obb_count;             // OBBæ•°é‡                                             
                                                                                       
  // é˜Ÿåˆ—æŒ‡æ ‡                                                                          
  size_t obstacle_queue_size;   // éšœç¢ç‰©é˜Ÿåˆ—æ·±åº¦                                      
  size_t pose_queue_size;       // ä½å§¿é˜Ÿåˆ—æ·±åº¦                                        
};                                                                                     
                                                                                       
å®ç°ï¼ˆRAIIè®¡æ—¶å™¨ï¼‰:                                                                    
                                                                                       
class ScopedTimer {                                                                    
 public:                                                                               
  ScopedTimer(const std::string& name, double& output)                                 
    : name_(name), output_(output), start_(HighResClock::now()) {}                     
                                                                                       
  ~ScopedTimer() {                                                                     
    auto end = HighResClock::now();                                                    
    output_ = std::chrono::duration<double, std::milli>(                               
      end - start_).count();                                                           
                                                                                       
    if (output_ > 100.0) {  // è¶…è¿‡100msè­¦å‘Š                                           
      MM_WARN("[Perf] %s took %.2fms (slow!)",                                         
              name_.c_str(), output_);                                                 
    }                                                                                  
  }                                                                                    
                                                                                       
 private:                                                                              
  std::string name_;                                                                   
  double& output_;                                                                     
  HighResClock::time_point start_;                                                     
};                                                                                     
                                                                      
// ä½¿ç”¨ç¤ºä¾‹                                                           
void LCPS::processFrame(...) {                                        
  PerformanceMetrics perf;                                            
                                                                      
  {                                                                   
    ScopedTimer timer("TotalFrame", perf.frame_time_ms);              
                                                                      
    {                                                                 
      ScopedTimer timer("OBBDetection", perf.obb_detection_ms);       
      // OBBæ£€æµ‹é€»è¾‘                                                  
    }                                                                 
                                                                      
    {                                                                 
      ScopedTimer timer("CollisionCheck", perf.collision_check_ms);   
      collisionCheck(...);                                            
    }                                                                 
                                                                      
    {                                                                 
      ScopedTimer timer("SafetyDecision", perf.decision_time_ms);     
      safetyDecision(...);                                            
    }                                                                 
  }                                                                   
                                                                      
  // æ”¶é›†å…¶ä»–æŒ‡æ ‡                                                     
  perf.fps = CalculateFPS();                                          
  perf.memory_usage_mb = GetMemoryUsage();                            
  perf.cpu_usage_percent = GetCPUUsage();                             
  perf.pointcloud_size = mpFullCloud->size();                         
  perf.obb_count = vObsOBB.size();                                    
                                                                      
  // ä¿å­˜åˆ°Frame                                                      
  frame.perf_metrics = perf;                                          
}                                                                     
                                                                      
æ€§èƒ½å¼‚å¸¸æ£€æµ‹:                                                         
                                                                      
bool AnomalyDetector::DetectPerformanceAnomaly(                       
    const PerformanceMetrics& perf) {                                 
                                                                      
  // æ£€æµ‹1: å¸§ç‡è¿‡ä½                                                  
  if (perf.fps < 20.0) {                                              
    low_fps_counter_++;                                               
    if (low_fps_counter_ > 150) {  // è¿ç»­5ç§’(30HzÃ—5s)                
      MM_WARN("[Perf] Low FPS detected: %.1f Hz", perf.fps);          
      return true;                                                    
    }                                                                 
  } else {                                                            
    low_fps_counter_ = 0;                                             
  }                                                                   
                                                                      
  // æ£€æµ‹2: å•å¸§è€—æ—¶è¿‡é•¿                                              
  if (perf.frame_time_ms > 100.0) {                                   
    MM_WARN("[Perf] Slow frame: %.2fms breakdown - "                  
            "OBB:%.2fms, Collision:%.2fms, Decision:%.2fms",          
            perf.frame_time_ms,                                       
            perf.obb_detection_ms,                                    
            perf.collision_check_ms,                                  
            perf.decision_time_ms);                                   
    return true;                                                      
  }                                                                   
                                                                      
  // æ£€æµ‹3: å†…å­˜æ³„æ¼                                                  
  if (perf.memory_usage_mb > last_memory_mb_ + 100) {                 
    MM_WARN("[Perf] Memory usage increased: %zu MB â†’ %zu MB",         
            last_memory_mb_, perf.memory_usage_mb);                   
    return true;                                                      
  }                                                                   
  last_memory_mb_ = perf.memory_usage_mb;                             
                                                                      
  return false;                                                       
}                                                                     
                                                                      
---                                                                   
åŠŸèƒ½6: æ™ºèƒ½å­˜å‚¨ç®¡ç†                                                              
                                                                                 
è®¾è®¡ç›®æ ‡: è‡ªåŠ¨ç®¡ç†ç£ç›˜ç©ºé—´ï¼Œé¿å…å­˜å‚¨æ»¡å¯¼è‡´å´©æºƒ                                   
                                                                                 
å­˜å‚¨ç­–ç•¥:                                                                        
                                                                                 
ç­–ç•¥1: è‡ªåŠ¨æ¸…ç†ï¼ˆä¿ç•™æœ€è¿‘Nå¤© + æ‰€æœ‰å¼‚å¸¸ï¼‰                                        
  - æ­£å¸¸å½•åˆ¶æ•°æ®ï¼šä¿ç•™æœ€è¿‘7å¤©                                                    
  - å¼‚å¸¸å½•åˆ¶æ•°æ®ï¼šæ°¸ä¹…ä¿ç•™ï¼ˆæˆ–ä¿ç•™30å¤©ï¼‰                                         
  - å®šæœŸæ‰«æï¼šæ¯å°æ—¶æ£€æŸ¥ä¸€æ¬¡                                                     
                                                                                 
ç­–ç•¥2: å­˜å‚¨é…é¢ç®¡ç†                                                              
  - æœ€å¤§ç£ç›˜å ç”¨ï¼š50GB                                                           
  - è¾¾åˆ°80%ï¼ˆ40GBï¼‰ï¼šè­¦å‘Š + åŠ é€Ÿæ¸…ç†                                             
  - è¾¾åˆ°95%ï¼ˆ47.5GBï¼‰ï¼šåœæ­¢å½•åˆ¶Layer 2+3                                         
                                                                                 
ç­–ç•¥3: åˆ†çº§å‹ç¼©                                                                  
  - Layer 1ï¼šä½å‹ç¼©ï¼ˆzstd level 3ï¼Œå¿«é€Ÿè®¿é—®ï¼‰                                    
  - Layer 2ï¼šä¸­å‹ç¼©ï¼ˆzstd level 6ï¼Œå¹³è¡¡ï¼‰                                        
  - Layer 3ï¼šé«˜å‹ç¼©ï¼ˆzstd level 9ï¼ŒèŠ‚çœç©ºé—´ï¼‰                                    
                                                                                 
å®ç°:                                                                            
                                                                                 
class StorageManager {                                                           
 public:                                                                         
  void RunPeriodicCleanup() {                                                    
    while (!stop_signal_) {                                                      
      std::this_thread::sleep_for(std::chrono::hours(1));                        
                                                                                 
      // æ£€æŸ¥ç£ç›˜ä½¿ç”¨ç‡                                                          
      size_t total_size = CalculateTotalSize(storage_path_);                     
      double usage_ratio = total_size / max_storage_bytes_;                      
                                                                                 
      MM_INFO("[Storage] Usage: %.1f%% (%zu MB / %zu MB)",                       
              usage_ratio * 100,                                                 
              total_size / 1024 / 1024,                                          
              max_storage_bytes_ / 1024 / 1024);                                 
                                                                                 
      // è§¦å‘æ¸…ç†                                                                
      if (usage_ratio > 0.80) {                                                  
        MM_WARN("[Storage] Usage > 80%, triggering cleanup");                    
        CleanupOldFiles(/*keep_days=*/3);  // ä¿ç•™3å¤©                            
      }                                                                          
                                                                                 
      if (usage_ratio > 0.95) {                                                  
        MM_ERROR("[Storage] Usage > 95%, disabling Layer 2+3");                  
        recording_config_.enable_layer2 = false;                                 
        recording_config_.enable_layer3 = false;                                 
      }                                                                          
    }                                                                            
  }                                                                              
                                                                                 
 private:                                                                        
  void CleanupOldFiles(int keep_days) {                                          
    auto cutoff_time = std::chrono::system_clock::now() -                        
                       std::chrono::hours(24 * keep_days);                       
                                                                                 
    for (const auto& entry :                                                     
         std::filesystem::directory_iterator(storage_path_)) {                   
                                                                                 
      // è·³è¿‡å¼‚å¸¸å½•åˆ¶æ–‡ä»¶ï¼ˆæ°¸ä¹…ä¿ç•™ï¼‰                                            
      if (IsAnomalyRecording(entry.path())) {                                    
        continue;                                                                
      }                                                                          
                                                                                 
      // åˆ é™¤æ—§æ–‡ä»¶                                                              
      auto file_time = std::filesystem::last_write_time(entry);                  
      if (file_time < cutoff_time) {                                             
        std::filesystem::remove(entry);                                          
        MM_INFO("[Storage] Deleted old file: %s",                                
                entry.path().c_str());                                           
      }                                                                          
    }                                                                            
  }                                                                              
                                                                                 
  bool IsAnomalyRecording(const std::filesystem::path& path) {                   
    // å¼‚å¸¸å½•åˆ¶æ–‡ä»¶å‘½ååŒ…å« "anomaly" å…³é”®è¯                                     
    return path.filename().string().find("anomaly") !=                           
           std::string::npos;                                                    
  }                                                                              
};                                                                               
                                                                                 
---                                                                              
åŠŸèƒ½7: è‡ªåŠ¨åŒ–å¼‚å¸¸æŠ¥å‘Šç”Ÿæˆ                                                                      
                                                                                               
è®¾è®¡ç›®æ ‡: å¼‚å¸¸å‘ç”Ÿåè‡ªåŠ¨ç”Ÿæˆç»“æ„åŒ–æŠ¥å‘Š                                                         
                                                                                               
æŠ¥å‘Šå†…å®¹:                                                                                      
                                                                                               
# LCPS å¼‚å¸¸æŠ¥å‘Š                                                                                
                                                                                               
**å¼‚å¸¸ID**: ANOMALY_2025122501234                                                              
**å‘ç”Ÿæ—¶é—´**: 2025-12-25 14:32:15.678                                                          
**å¼‚å¸¸ç±»å‹**: ç¢°æ’ (COLLISION)                                                                 
**ä¸¥é‡æ€§**: ğŸ”´ Critical                                                                        
                                                                                               
---                                                                                            
                                                                                               
## ğŸ“‹ å¼‚å¸¸æ¦‚è¦                                                                                 
                                                                                               
- **å¼‚å¸¸æè¿°**: åŠå…·ä¸éšœç¢ç‰©ç¢°æ’                                                               
- **ç¢°æ’è·ç¦»**: 1.8m (ä½äºSTOPé˜ˆå€¼2.0m)                                                        
- **åŠå…·é€Ÿåº¦**: 0.5m/s                                                                         
- **éšœç¢ç‰©ç±»å‹**: é›†è£…ç®±                                                                       
- **å†³ç­–ç»“æœ**: STOP (ç´§æ€¥åœè½¦)                                                                
                                                                                               
---                                                                                            
                                                                                               
## ğŸ“Š æ—¶é—´çº¿åˆ†æ                                                                               
                                                                                               
### å¼‚å¸¸å‰30ç§’å…³é”®äº‹ä»¶                                                                         
                                                                                               
| æ—¶é—´åç§» | äº‹ä»¶ | æœ€å°è·ç¦» | å†³ç­– | è¯´æ˜ |                                                   
|---------|------|---------|------|------|                                                     
| T-30s | å¼€å§‹ç§»åŠ¨ | 15.2m | SAFE | åŠå…·å¯åŠ¨ |                                                 
| T-20s | æ£€æµ‹åˆ°éšœç¢ç‰© | 8.5m | SAFE | é¦–æ¬¡æ£€æµ‹ |                                              
| T-10s | æ¥è¿‘è­¦å‘ŠåŒº | 4.2m | SLOW | å‡é€Ÿ |                                                    
| T-5s | è¿›å…¥å±é™©åŒº | 2.8m | SLOW | æŒç»­å‡é€Ÿ |                                                 
| T-2s | æ¥è¿‘åœæ­¢é˜ˆå€¼ | 2.3m | SLOW | å³å°†åœè½¦ |                                               
| **T=0s** | **ç¢°æ’å‘ç”Ÿ** | **1.8m** | **STOP** | **ç´§æ€¥åœè½¦** |                               
                                                                                               
### å¼‚å¸¸å10ç§’å…³é”®äº‹ä»¶                                                                         
                                                                                               
| æ—¶é—´åç§» | äº‹ä»¶ | è¯´æ˜ |                                                                     
|---------|------|------|                                                                      
| T+0.1s | ç´§æ€¥åˆ¶åŠ¨ | åŠå…·åœæ­¢ |                                                               
| T+1s | ä¿å­˜æ•°æ® | å½•åˆ¶å®Œæˆ |                                                                 
| T+3s | æŠ¥è­¦è§¦å‘ | å‘é€æŠ¥è­¦ä¿¡å· |                                                             
                                                                                               
---                                                                                            
                                                                                               
## ğŸ¯ å†³ç­–è·¯å¾„åˆ†æ                                                                             
                                                                                               
ObstacleDetection (95%)                                                                        
  â”œâ”€ Input: pointcloud=98532 points, obb_count=3                                               
  â”œâ”€ Output: min_distance=1.8m                                                                 
  â””â”€ Reason: "Detected 3 obstacles, closest at 1.8m"                                           
      â†“                                                                                        
CollisionPrediction (88%)                                                                      
  â”œâ”€ Input: speed=0.5m/s, distance=1.8m                                                        
  â”œâ”€ Output: collision_time=3.6s                                                               
  â””â”€ Reason: "Collision imminent in 3.6s"                                                      
      â†“                                                                                        
SafetyDecision (100%)                                                                          
  â”œâ”€ Input: distance=1.8m, threshold=2.0m                                                      
  â”œâ”€ Output: decision=STOP                                                                     
  â””â”€ Reason: "Distance < STOP threshold (2.0m)"                                                
      â†“                                                                                        
Final Decision: STOP âŒ                                                                        
                                                                                               
---                                                                                            
                                                                                               
## ğŸ“ˆ æ€§èƒ½åˆ†æ                                                                                 
                                                                                               
### å¸§ç‡æ›²çº¿                                                                                   
                                                                                               
FPS                                                                                            
60 â”¤                                                                                           
50 â”¤                                                                                           
40 â”¤                                                                                           
30 â”¤ â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”                                                           
20 â”¤                                                                                           
10 â”¤                                                                                           
 0 â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                        
   T-30s              T=0s        T+10s                                                        
                                                                                               
### å¤„ç†æ—¶é—´åˆ†è§£                                                                               
                                                                                               
| æ¨¡å— | å¹³å‡è€—æ—¶ | æœ€å¤§è€—æ—¶ | å æ¯” |                                                          
|------|---------|---------|------|                                                            
| OBBæ£€æµ‹ | 8.2ms | 12.5ms | 25% |                                                             
| ç¢°æ’æ£€æŸ¥ | 15.3ms | 22.1ms | 47% |                                                           
| å®‰å…¨å†³ç­– | 5.1ms | 7.8ms | 16% |                                                             
| å…¶ä»– | 3.9ms | 5.2ms | 12% |                                                                 
| **æ€»è®¡** | **32.5ms** | **47.6ms** | **100%** |                                              
                                                                                               
### èµ„æºä½¿ç”¨                                                                                   
                                                                                               
- **å†…å­˜**: 458 MB (å³°å€¼)                                                                      
- **CPU**: 35% (å¹³å‡)                                                                          
- **ç‚¹äº‘å¤§å°**: 98,532 points                                                                  
- **OBBæ•°é‡**: 3 obstacles                                                                     
                                                                                               
---                                                                                            
                                                                                               
## ğŸ—‚ï¸ ç›¸å…³æ•°æ®æ–‡ä»¶                                                                              
                                                                                               
### HDF5å½•åˆ¶æ–‡ä»¶                                                                               
- **æ–‡ä»¶è·¯å¾„**: `/debug/anomaly_2025122501234.h5`                                              
- **æ–‡ä»¶å¤§å°**: 1.2 GB                                                                         
- **æ•°æ®æ—¶é—´èŒƒå›´**: T-30s åˆ° T+10s (40ç§’)                                                      
- **åŒ…å«æ•°æ®å±‚çº§**: Layer 1 + Layer 2 + Layer 3                                                
                                                                                               
### å¯è§†åŒ–å›¾åƒ                                                                                 
- OBBå¯è§†åŒ–: `/debug/anomaly_2025122501234_obb.png`                                            
- ç‚¹äº‘å¯è§†åŒ–: `/debug/anomaly_2025122501234_pc.png`                                            
- æ—¶é—´çº¿å›¾è¡¨: `/debug/anomaly_2025122501234_timeline.png`                                      
                                                                                               
---                                                                                            
                                                                                               
## ğŸ’¡ æ ¹å› åˆ†æ                                                                                 
                                                                                               
**å¯èƒ½åŸå› **:                                                                                  
1. âœ… åŠå…·é€Ÿåº¦æœªåŠæ—¶å‡é€Ÿï¼ˆ0.5m/sè¿‡å¿«ï¼‰                                                         
2. âš ï¸ SLOWé˜ˆå€¼è®¾ç½®è¿‡å°ï¼ˆ3.5må¯èƒ½ä¸å¤Ÿï¼‰                                                          
3. âš ï¸ ä¼ æ„Ÿå™¨å»¶è¿Ÿå¯¼è‡´æ£€æµ‹æ»å                                                                    
                                                                                               
**å»ºè®®æ”¹è¿›**:                                                                                  
1. è°ƒæ•´SLOWé˜ˆå€¼ï¼š3.5m â†’ 4.5m                                                                   
2. å¢åŠ å‡é€Ÿæ¯”ä¾‹ï¼šé‡åˆ°éšœç¢ç‰©æ—¶ç«‹å³å‡é€Ÿ50%                                                       
3. æ·»åŠ é¢„æµ‹æ€§å‡é€Ÿï¼šæ ¹æ®éšœç¢ç‰©ä½ç½®é¢„åˆ¤                                                          
                                                                                               
---                                                                                            
                                                                                               
**æŠ¥å‘Šç”Ÿæˆæ—¶é—´**: 2025-12-25 14:33:20                                                          
**æŠ¥å‘Šç‰ˆæœ¬**: v1.0                                                                             
                                                                                               
ç”Ÿæˆä»£ç :                                                                                      
                                                                                               
void BlackBoxRecorder::GenerateAnomalyReport(                                                  
    const std::string& hdf5_filename,                                                          
    AnomalyType type,                                                                          
    const std::string& reason) {                                                               
                                                                                               
  // ç”ŸæˆMarkdownæŠ¥å‘Š                                                                          
  std::string report_filename =                                                                
    hdf5_filename.replace(".h5", "_report.md");                                                
                                                                                               
  std::ofstream report(report_filename);                                                       
                                                                                               
  // å¤´éƒ¨ä¿¡æ¯                                                                                  
  report << "# LCPS å¼‚å¸¸æŠ¥å‘Š\n\n";                                                             
  report << fmt::format("**å¼‚å¸¸ID**: {}\n", anomaly_id_);                                      
  report << fmt::format("**å‘ç”Ÿæ—¶é—´**: {}\n", FormatTime(anomaly_time_));                      
  report << fmt::format("**å¼‚å¸¸ç±»å‹**: {}\n", AnomalyTypeToString(type));                      
  report << fmt::format("**ä¸¥é‡æ€§**: {}\n\n", GetSeverityEmoji(type));                         
                                                                             
  // å¼‚å¸¸æ¦‚è¦                                                                
  GenerateSummarySection(report, type, reason);                              
                                                                             
  // æ—¶é—´çº¿åˆ†æ                                                              
  GenerateTimelineSection(report, anomaly_data_);                            
                                                                             
  // å†³ç­–è·¯å¾„                                                                
  GenerateDecisionTraceSection(report, anomaly_data_);                       
                                                                             
  // æ€§èƒ½åˆ†æ                                                                
  GeneratePerformanceSection(report, anomaly_data_);                         
                                                                             
  // ç›¸å…³æ–‡ä»¶                                                                
  GenerateDataFilesSection(report, hdf5_filename);                           
                                                                             
  // æ ¹å› åˆ†æ                                                                
  GenerateRootCauseSection(report, type, anomaly_data_);                     
                                                                             
  report.close();                                                            
                                                                             
  MM_INFO("[BlackBox] Anomaly report generated: %s",                         
          report_filename.c_str());                                          
}                                                                            
                                                                             
---                                                                          
ğŸ“‹ å®æ–½è·¯çº¿å›¾                                                                
                                                                             
Phase 1: æ ¸å¿ƒé»‘åŒ£å­åŠŸèƒ½ï¼ˆ3-4å‘¨ï¼ŒP0ï¼‰                                         
                                                                             
Week 1-2: ç¯å½¢ç¼“å†² + å¼‚å¸¸è§¦å‘                                                
- å®ç°BlackBoxRecorderç±»ï¼ˆç¯å½¢ç¼“å†²ç®¡ç†ï¼‰                                     
- å®ç°Frameæ•°æ®ç»“æ„ï¼ˆåˆ†å±‚æ•°æ®ï¼‰                                              
- é›†æˆåˆ°LCPSä¸»å¾ªç¯ï¼ˆéä¾µå…¥å¼ï¼‰                                               
- å®ç°ç¡¬å¼‚å¸¸æ£€æµ‹ï¼ˆç¢°æ’ã€ä¼ æ„Ÿå™¨æ•…éšœã€ç´§æ€¥åœè½¦ï¼‰                               
- å®ç°å¼‚å¸¸è§¦å‘å½•åˆ¶ï¼ˆå‰30ç§’+å10ç§’ï¼‰                                          
                                                                             
éªŒæ”¶æ ‡å‡†:                                                                    
- ç¯å½¢ç¼“å†²æ­£å¸¸è¿è¡Œï¼Œå†…å­˜å ç”¨<500MB                                           
- ç¢°æ’å‘ç”Ÿæ—¶è‡ªåŠ¨è§¦å‘å½•åˆ¶                                                     
- ä¿å­˜HDF5æ–‡ä»¶åŒ…å«å®Œæ•´40ç§’æ•°æ®                                               
- ä¸»é€»è¾‘æ€§èƒ½å¼€é”€<2%                                                          
                                                                             
Week 3-4: HDF5å­˜å‚¨ + åŸºç¡€æŠ¥å‘Š                                                
- å®ç°HDF5å†™å…¥ï¼ˆåˆ†å±‚å­˜å‚¨ï¼Œå‹ç¼©ï¼‰                                             
- å®ç°æ—¶é—´æˆ³ç´¢å¼•ï¼ˆå¿«é€ŸæŸ¥è¯¢ï¼‰                                                 
- å®ç°åŸºç¡€å¼‚å¸¸æŠ¥å‘Šç”Ÿæˆï¼ˆMarkdownæ ¼å¼ï¼‰                                       
- æ·»åŠ å­˜å‚¨ç®¡ç†ï¼ˆè‡ªåŠ¨æ¸…ç†ï¼‰                                                   
                                                                             
éªŒæ”¶æ ‡å‡†:                                                                    
- HDF5æ–‡ä»¶å¯è¢«OBBViewerå·¥å…·è¯»å–                                              
- æŠ¥å‘ŠåŒ…å«æ—¶é—´çº¿ã€å†³ç­–è·¯å¾„ã€æ€§èƒ½æ•°æ®                                         
- è‡ªåŠ¨æ¸…ç†æ—§æ–‡ä»¶ï¼Œç£ç›˜å ç”¨å¯æ§                                               
                                                                             
---                                                                          
Phase 2: é«˜çº§åŠŸèƒ½ï¼ˆ3-4å‘¨ï¼ŒP1ï¼‰                                               
                                                                             
Week 5-6: å†³ç­–è·¯å¾„å›æº¯                                                       
- å®ç°DecisionTraceæ•°æ®ç»“æ„                                                  
- é›†æˆåˆ°collisionCheckå‡½æ•°                                                   
- è®°å½•å†³ç­–æ ‘è·¯å¾„ï¼ˆæ¯ä¸ªèŠ‚ç‚¹çš„è¾“å…¥è¾“å‡ºï¼‰                                       
- å¯è§†åŒ–å†³ç­–è·¯å¾„ï¼ˆæŠ¥å‘Šä¸­è‡ªåŠ¨ç”Ÿæˆï¼‰                                           
                                                                             
Week 7-8: æ€§èƒ½ç›‘æ§ + è½¯å¼‚å¸¸æ£€æµ‹                                              
- å®ç°PerformanceMetricsæ”¶é›†ï¼ˆRAIIè®¡æ—¶å™¨ï¼‰                                   
- å®ç°è½¯å¼‚å¸¸æ£€æµ‹ï¼ˆæ€§èƒ½ä¸‹é™ã€å†³ç­–æŠ–åŠ¨ã€å»¶è¿Ÿï¼‰                                 
- é›†æˆæ€§èƒ½æ•°æ®åˆ°æŠ¥å‘Š                                                         
- æ€§èƒ½æ›²çº¿å¯è§†åŒ–                                                             
                                                                             
---                                                                          
Phase 3: æ™ºèƒ½ä¼˜åŒ–ï¼ˆ2-3å‘¨ï¼ŒP2ï¼‰                                               
                                                                             
Week 9-10: é¢„æµ‹å¼‚å¸¸ + è‡ªé€‚åº”å½•åˆ¶                                             
- å®ç°é¢„æµ‹å¼‚å¸¸æ£€æµ‹ï¼ˆæ¥è¿‘ç¢°æ’ã€é¢‘ç¹å‡é€Ÿï¼‰                                     
- è‡ªé€‚åº”é‡‡æ ·ï¼ˆå¸¸æ€10%ï¼Œå¼‚å¸¸100%ï¼‰                                            
- æ™ºèƒ½å­˜å‚¨é…é¢ç®¡ç†                                                           
Week 11: ä¸OBBViewerå·¥å…·é›†æˆ                                                                                   
- åŒæ¨¡å¼è¿è¡Œï¼ˆå®æ—¶æµ+ç¦»çº¿å½•åˆ¶ï¼‰                                                                                
- æ•°æ®æ ¼å¼å¯¹é½ï¼ˆä¸DataRecorderç»Ÿä¸€ï¼‰                                                                           
- æ”¯æŒOBBViewerå›æ”¾é»‘åŒ£å­æ•°æ®                                                                                  
                                                                                                               
---                                                                                                            
ğŸ“Š æˆæœ¬æ•ˆç›Šåˆ†æ                                                                                                
                                                                                                               
å¼€å‘æˆæœ¬                                                                                                       
                                                                                                               
| Phase   | å·¥ä½œé‡     | äººå‘˜  | æ—¶é—´   |                                                                      
|---------|------------|-------|--------|                                                                      
| Phase 1 | æ ¸å¿ƒé»‘åŒ£å­ | 1-2äºº | 3-4å‘¨  |                                                                      
| Phase 2 | é«˜çº§åŠŸèƒ½   | 1äºº   | 3-4å‘¨  |                                                                      
| Phase 3 | æ™ºèƒ½ä¼˜åŒ–   | 1äºº   | 2-3å‘¨  |                                                                      
| æ€»è®¡    | -          | 1-2äºº | 8-11å‘¨ |                                                                      
                                                                                                               
æ€§èƒ½å¼€é”€                                                                                                       
                                                                                                               
| æŒ‡æ ‡     | å¸¸æ€è¿è¡Œ    | å¼‚å¸¸å½•åˆ¶   | è¯´æ˜                  |                                                
|----------|-------------|------------|-----------------------|                                                
| CPUå¼€é”€  | <2%         | <5%        | ç¯å½¢ç¼“å†²å†™å…¥+å¼‚å¸¸æ£€æµ‹ |                                                
| å†…å­˜å ç”¨ | ~450MB      | ~500MB     | ç¯å½¢ç¼“å†²(Layer 1+2)   |                                                
| ç£ç›˜å ç”¨ | ~540MB/å°æ—¶ | ~65GB/å°æ—¶ | Layer 1 / Layer 1+2+3 |                                                
| ç½‘ç»œå¸¦å®½ | 0           | 0          | æœ¬åœ°å½•åˆ¶ï¼Œæ— ç½‘ç»œ      |                                                
                                                                                                               
æ”¶ç›Šè¯„ä¼°                                                                                                       
                                                                                                               
| æ”¶ç›Šç±»å‹     | é‡åŒ–æŒ‡æ ‡                    | ä»·å€¼       |                                                    
|--------------|-----------------------------|------------|                                                    
| è°ƒè¯•æ•ˆç‡æå‡ | å¼‚å¸¸å®šä½æ—¶é—´ï¼šæ•°å°æ—¶â†’æ•°åˆ†é’Ÿ | â­â­â­â­â­ |                                                    
| æ•…éšœé‡ç°èƒ½åŠ› | å¼‚å¸¸é‡ç°ç‡ï¼š30%â†’95%         | â­â­â­â­â­ |                                                    
| æ ¹å› åˆ†æèƒ½åŠ› | æ ¹å› è¯†åˆ«ç‡ï¼š50%â†’90%         | â­â­â­â­   |                                                    
| ç³»ç»Ÿå¯é æ€§   | æœªçŸ¥æ•…éšœå‡å°‘50%             | â­â­â­â­   |                                                    
| å¼€å‘è¿­ä»£é€Ÿåº¦ | Bugä¿®å¤å‘¨æœŸç¼©çŸ­60%          | â­â­â­â­   |                                                    
                                                                                                               
ROI: æŠ•å…¥8-11å‘¨å¼€å‘ï¼Œé•¿æœŸæ”¶ç›Šæ˜¾è‘—ï¼ˆè°ƒè¯•æ•ˆç‡æå‡10å€+ï¼‰                                                         
                                                                                                               
---                                                                                                            
âœ… æ‰§è¡Œæ£€æŸ¥æ¸…å•                                                                                                
                                                                                                               
- å·²ä½¿ç”¨Sequential-thinkingè¿›è¡Œ10æ­¥å¤´è„‘é£æš´                                                                    
- å·²è¯„ä¼°LCPSå½“å‰è°ƒè¯•åŠŸèƒ½å®Œå¤‡æ€§ï¼ˆ55/100åˆ†ï¼‰                                                                     
- å·²è¯†åˆ«5ä¸ªå…³é”®ç¼ºé™·ï¼ˆå¼‚å¸¸å‰æ•°æ®ç¼ºå¤±ã€æ‰‹åŠ¨è§¦å‘ã€æ–‡ä»¶ç¢ç‰‡åŒ–ã€ç¼ºå°‘æ€§èƒ½æ•°æ®ã€å†³ç­–ä¸é€æ˜ï¼‰                          
- å·²è®¾è®¡8ä¸ªåˆ›æ–°åŠŸèƒ½ï¼ˆç¯å½¢ç¼“å†²ã€æ™ºèƒ½å¼‚å¸¸æ£€æµ‹ã€åˆ†å±‚å½•åˆ¶ã€å†³ç­–å›æº¯ã€æ€§èƒ½ç›‘æ§ã€å­˜å‚¨ç®¡ç†ã€å®æ—¶æµã€è‡ªåŠ¨æŠ¥å‘Šï¼‰        
- å·²åˆ¶å®šè¯¦ç»†å®æ–½è·¯çº¿å›¾ï¼ˆ3ä¸ªPhaseï¼Œ8-11å‘¨ï¼‰                                                                     
- å·²è¿›è¡Œæˆæœ¬æ•ˆç›Šåˆ†æï¼ˆROIæ˜¾è‘—ï¼‰                                                                                
- å·²æä¾›å®Œæ•´ä»£ç ç¤ºä¾‹å’Œæ¶æ„è®¾è®¡                                                                                 
                                                                                                               
---                                                                                                            
ğŸ“Œ æ ¸å¿ƒç»“è®º                                                                                                    
                                                                                                               
å½“å‰è°ƒè¯•åŠŸèƒ½è¯„ä¼°                                                                                               
                                                                                                               
ç»¼åˆè¯„åˆ†: â­â­â­ (55/100)                                                                                      
                                                                                                               
ä¸»è¦é—®é¢˜:                                                                                                      
1. ğŸ”´ æ— æ³•å½•åˆ¶"å¸Œæœ›å½•åˆ¶çš„æ•°æ®" - ç¼ºå°‘å¼‚å¸¸å‰ä¸Šä¸‹æ–‡                                                              
2. ğŸ”´ æ‰‹åŠ¨è§¦å‘ä½æ•ˆ - ç”Ÿäº§ç¯å¢ƒé»˜è®¤å…³é—­ï¼Œé—æ¼å¶å‘å¼‚å¸¸                                                            
3. ğŸŸ¡ æ–‡ä»¶ç¢ç‰‡åŒ– - æ•°åƒä¸ªå°æ–‡ä»¶ï¼ŒæŸ¥è¯¢å’Œå›æ”¾å›°éš¾                                                                
4. ğŸ”´ å†³ç­–è¿‡ç¨‹ä¸é€æ˜ - åªæœ‰ç»“æœï¼Œæ— æ³•åˆ†æ"ä¸ºä»€ä¹ˆ"                                                              
5. ğŸ”´ ç¼ºå°‘æ€§èƒ½æ•°æ® - æ— æ³•å®šä½æ€§èƒ½ç“¶é¢ˆ                                                                          
                                                                                                               
ä¼˜åŒ–å»ºè®®                                                                                                       
                                                                                                               
æ ¸å¿ƒç†å¿µ: é»‘åŒ£å­å¼è°ƒè¯•ç³»ç»Ÿï¼ˆç±»æ¯”èˆªç©ºFDR + æ±½è½¦EDRï¼‰                                                            
                                                                                                               
å…³é”®åˆ›æ–°:                                                                                                      
1. âœ… ç¯å½¢ç¼“å†² - æŒç»­å½•åˆ¶æœ€è¿‘30ç§’ï¼Œå¼‚å¸¸è§¦å‘è‡ªåŠ¨ä¿å­˜                                                            
2. âœ… æ™ºèƒ½å¼‚å¸¸æ£€æµ‹ - 8ç±»å¼‚å¸¸è‡ªåŠ¨è¯†åˆ«ï¼Œé›¶é…ç½®                                                                   
3. âœ… å†³ç­–è·¯å¾„å›æº¯ - è®°å½•å®Œæ•´å†³ç­–é€»è¾‘ï¼Œå¯è§£é‡ŠAI                                                                
4. âœ… åµŒå…¥å¼æ€§èƒ½ç›‘æ§ - å®æ—¶æ£€æµ‹ç“¶é¢ˆï¼Œè‡ªåŠ¨æŠ¥è­¦                                                                  
5. âœ… è‡ªåŠ¨åŒ–æŠ¥å‘Š - å¼‚å¸¸å‘ç”Ÿåè‡ªåŠ¨ç”Ÿæˆç»“æ„åŒ–åˆ†ææŠ¥å‘Š                                                            
                                                                                                               
å®æ–½ä¼˜å…ˆçº§:                                                                                                    
- P0 (Phase 1): ç¯å½¢ç¼“å†² + å¼‚å¸¸è§¦å‘ + HDF5å­˜å‚¨                                                                 
- P1 (Phase 2): å†³ç­–è·¯å¾„å›æº¯ + æ€§èƒ½ç›‘æ§                                                                        
- P2 (Phase 3): é¢„æµ‹å¼‚å¸¸ + OBBVieweré›†æˆ                                                                       
